<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version last-->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="fact_resume" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="2c4e7b6f-92b9-48d7-98b9-62812e77fcfb">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="pimsdriver"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="pmel_root" class="java.lang.Long"/>
	<queryString language="SQL">
		<![CDATA[WITH distinctrss AS (
  SELECT DISTINCT numrss
    FROM smva_rssmain_116_view
    WHERE pmel_root = $P{pmel_root}::bigint
)
SELECT b.codeacte,
       b.numghs,
       SUM(b.quantite::integer) quantite,
       SUM(montanttotaldepense::integer) montanttotaldepense,
       dr.numrss IS NOT NULL hospit
  FROM favb_rsfb_2012_view b
  LEFT JOIN distinctrss dr ON
       b.numrss = dr.numrss
  WHERE b.pmel_root = $P{pmel_root}::bigint
  GROUP BY b.codeacte, b.numghs, dr.numrss IS NOT NULL
  ORDER BY dr.numrss IS NOT NULL DESC, b.codeacte, b.numghs;]]>
	</queryString>
	<field name="codeacte" class="java.lang.String"/>
	<field name="numghs" class="java.lang.String"/>
	<field name="quantite" class="java.lang.Long"/>
	<field name="montanttotaldepense" class="java.lang.Long"/>
	<field name="hospit" class="java.lang.Boolean"/>
	<group name="hospit">
		<groupExpression><![CDATA[$F{hospit}]]></groupExpression>
		<groupHeader>
			<band height="40">
				<property name="local_mesure_unitheight" value="pixel"/>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
				<textField>
					<reportElement x="5" y="0" width="545" height="20" uuid="f1867694-aa3b-477e-8672-0347e23ed51c">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="local_mesure_unitwidth" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
						<property name="local_mesure_unitx" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.x" value="px"/>
					</reportElement>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{hospit} ? "Avec RSS" : "Sans RSS"]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="5" y="24" width="135" height="16" uuid="cea70249-7a61-4da8-bf7d-57ecfe6e42c6">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="local_mesure_unitx" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.x" value="px"/>
						<property name="local_mesure_unitwidth" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<textElement verticalAlignment="Middle">
						<paragraph leftIndent="2" rightIndent="2"/>
					</textElement>
					<text><![CDATA[Acte]]></text>
				</staticText>
				<staticText>
					<reportElement x="141" y="24" width="199" height="16" uuid="724529c5-3dba-4ce5-b9b0-da295e3608a8">
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<paragraph leftIndent="2" rightIndent="2"/>
					</textElement>
					<text><![CDATA[Quantité]]></text>
				</staticText>
				<staticText>
					<reportElement x="340" y="24" width="210" height="16" uuid="e1e4ef9a-5b51-485f-b324-c6ad901cf51f">
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="local_mesure_unitwidth" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<paragraph leftIndent="2" rightIndent="2"/>
					</textElement>
					<text><![CDATA[Montant Total Dépense]]></text>
				</staticText>
				<frame>
					<reportElement x="0" y="0" width="555" height="40" uuid="c4632f6d-7f66-40a3-9f2b-7e9c55d04123">
						<property name="local_mesure_unitwidth" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<box>
						<leftPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
				</frame>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="35">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<staticText>
				<reportElement x="5" y="5" width="545" height="20" uuid="ae9a87d8-c59f-4fbd-b199-431d6d3cac5e">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="16"/>
				</textElement>
				<text><![CDATA[Récapitulatif :]]></text>
			</staticText>
			<frame>
				<reportElement x="0" y="0" width="555" height="35" uuid="92c85b7e-9b01-479d-8033-17f367ea07b6">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
			</frame>
		</band>
	</title>
	<detail>
		<band height="16" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<textField>
				<reportElement x="5" y="0" width="135" height="16" uuid="23759d79-2692-405d-bad3-c694e3a20974">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="2" rightIndent="2" spacingBefore="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codeacte}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="140" y="0" width="200" height="16" uuid="58bf47a4-bc88-45cf-8e4c-797e5a26062f">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="DejaVu Sans Mono"/>
					<paragraph leftIndent="2" rightIndent="2" spacingBefore="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantite}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="340" y="0" width="210" height="16" uuid="4b68f402-9498-4ebc-aea0-3d21d52e1e84">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="DejaVu Sans Mono"/>
					<paragraph leftIndent="2" rightIndent="2" spacingBefore="0"/>
				</textElement>
				<textFieldExpression><![CDATA[new DecimalFormat("+#,##0.00;-#,##0.00", new DecimalFormatSymbols(Locale.FRANCE)).format(new BigDecimal($F{montanttotaldepense}).divide(new BigDecimal(100)))]]></textFieldExpression>
			</textField>
			<frame>
				<reportElement x="0" y="0" width="555" height="16" uuid="45466d68-ad8d-4119-98a2-598c73c0ec06">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<leftPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
			</frame>
		</band>
	</detail>
	<summary>
		<band height="30" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<staticText>
				<reportElement x="5" y="5" width="545" height="20" uuid="2e8e9d46-b647-4d3d-be90-0736d1376e57">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Justified">
					<font size="8"/>
					<paragraph firstLineIndent="10"/>
				</textElement>
				<text><![CDATA[Attention, ce rapport ne rejette aucune facture. Pour comparer avec les tableaux DATIM  de l'ATIH, il faut également enlever de ce rapport les lignes B rejetées dans la valorisation.]]></text>
			</staticText>
			<frame>
				<reportElement x="0" y="0" width="555" height="30" uuid="1083f8de-be6d-43a0-9ab5-5b9df779532b">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
			</frame>
		</band>
	</summary>
</jasperReport>
